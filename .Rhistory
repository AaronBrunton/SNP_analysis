# Plot
gap.barplot(val, gap=c(0,0), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
# Plot
gap.barplot(val, gap=c(0,0.00001), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
# Plot
gap.barplot(val, gap=c(0.000000001,0.00001), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
x <- c(1:5, 6.9, 7)
y <- 2^x
y
val
# Load package
library(plotrix)
# Bring in data
labs <- c('Brain', 'Brain FB', 'Thoracic', 'Hemolym')
val <- c(1, 0.427, 0.834, 20.349)
to_plot <- data.frame(val)
# Bring in data
labs <- c('Brain', 'Brain FB', 'Thoracic', 'Hemolym')
val <- c(1, 0.427, 0.834, 20.349)
# What is our gap
from <- 4
to <- 19
# Plot
gap.barplot(val, col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
val <- t(c(1, 0.427, 0.834, 20.349))
View(val)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression", xaxlab = labs, ytics = c(0,2,4,20,22,24))
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4))
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4), ylim = (0,25))
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4), ylim = c(0,25))
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4), ylim = c(0,25))
x <- c(1:5, 6.9, 7)
y <- 2^x
val <- c(1, 0.427, 0.834, 20.349)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4), ylim = c(0,25))
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4))
val <- c(0.427, 0.834, 1, 20.349)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4))
x <- c(1:5, 6.9, 7)
y <- 2^x
gap.barplot(y, gap=c(from,to), col=as.numeric(x),
xlab="index", ylab="value")
install.packages("plotrix", dependencies = FALSE)
install.packages("plotrix", dependencies = FALSE)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4))
# Load package
library(plotrix)
# Plot
gap.barplot(val, gap=c(from,to), col= c('blue', 'red', 'navy', 'cyan'), xlab="Tissue", ylab="Expression",
xaxlab = labs, ytics = c(0,2,4,20,22,24), xtics = c(1,2,3,4))
install.packages("ggbreak", dependencies = FALSE)
library(ggbreak)
library(ggplot2)
to_plot <- data.frame(val)
View(to_plot)
rownames(to_plot) <- labs
View(to_plot)
ggplot(to_plot, aes(val, x)) + geom_col(orientation = "y")
ggplot(to_plot, aes(val, x)) + geom_col(orientation = "val")
to_plot$tissue <- labs
View(to_plot)
ggplot(to_plot, aes(val, tisue)) + geom_col(orientation = "val")
ggplot(to_plot, aes(val, tissue)) + geom_col(orientation = "val")
ggplot(to_plot, aes(val, tissue)) + geom_col(orientation = "tissue")
ggplot(to_plot, aes(tissue, val)) + geom_col()
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(tissue, val)) + geom_col()
p1 + scale_y_break(c(4,20))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,30))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) + scale_y_continuous(breaks = c(0,2,4,20,22,24))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) + scale_y_continuous(limtits = c(0,2,4,20,22,24), breaks = c(0,2,4,20,22,24))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
scale_y_continuous(limits = c(0,2,4,20,22,24), breaks = c(0,2,4,20,22,24))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24))
to_plot$ord <- c(1,2,3,4)
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_col()
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24))
to_plot$sem <- c(0.024,0.017,0.167,2.448)
View(to_plot)
ggplot(to_plot, aes(ord, val)) + geom_col() + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_col() + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24))
to_plot$col <- c('lightblue','dodgerblue','lightsalmon','salmon')
ggplot(to_plot, aes(ord, val)) + geom_col(fill = col) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
gplot(to_plot, aes(ord, val)) + geom_bar(fill = col) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
ggplot(to_plot, aes(ord, val)) + geom_bar(fill = col) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
ggplot(to_plot, aes(ord, val)) + geom_bar(aes(x = ord, y = val), stat = 'identity', fill = col) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = col) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('lightblue','dodgerblue','lightsalmon','salmon')) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) + geom_errorbar(aes(x = ord, ymin = val-sem, ymax = val+sem),
width = 0.4, color = 'black')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) + labs(y = "Relative fmr1 Expression", x = NULL)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative", italic(fmr1), "Expression")), x = NULL)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic()
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() + ggtitle('Day 9 Male Tissues')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
ggtitle('Day 9 Male Tissues', hjust = 0.5)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
ggtitle('Day 9 Male Tissues') + theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
scale_x_discrete(labels = labs) + ggtitle('Day 9 Male Tissues') + theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
scale_x_discrete(labels = c("1" = Labs[1], "2" = Labs[2], "3" = Labs[3], "4" = Labs[4])) + ggtitle('Day 9 Male Tissues') +
theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
scale_x_discrete(labels = c("1" = labs[1], "2" = labs[2], "3" = labs[3], "4" = labs[4])) + ggtitle('Day 9 Male Tissues') +
theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
scale_x_discrete(breaks = c("1","2","3","4"), labels = c("1" = labs[1], "2" = labs[2], "3" = labs[3], "4" = labs[4])) + ggtitle('Day 9 Male Tissues') +
theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
scale_x_discrete(labels = c("Brain", "Brain FB", "Thoracic", "Hemolym")) + ggtitle('Day 9 Male Tissues') +
theme(plot.title = element_text(hjust = 0.5))
ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black') +
scale_x_discrete(labels = c("Brain", "Brain FB", "Thoracic", "Hemolym")) + ggtitle('Day 9 Male Tissues')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(labels = labs)
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black') +
+ ggtitle('Day 9 Male Tissues')
# Plot using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(labels = labs)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_continuous(labels = labs)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(labels = labs)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")))  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(labels = labs)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(breaks = c(1,2,3,4), labels = labs)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(breaks = c(1,2,3,4),
labels = c('Brain', 'Brain FB', 'Thoracic', 'Hemolym'))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5)
)
ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black') +
scale_x_discrete(breaks = c(1,2,3,4), labels = c('Brain', 'Brain FB', 'Thoracic', 'Hemolym'))
ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black') +
scale_x_discrete(labels = c('Brain', 'Brain FB', 'Thoracic', 'Hemolym'))
# Plot male data using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL)  + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) + xlab(NULL) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) + xlab("") +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = NULL)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.ticks.x = element_blank())
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = labs)
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(labs))
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
# Plot male data using ggbreak and ggplot2
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black')
p1 + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
val_f <- c(1, 0.145, 1.363, 14.855)
to_plot_f <- data.frame(val_f)
to_plot_f$tissue <- labs
to_plot_f$ord <- c(1,2,3,4)
to_plot_f$sem <- c(0.024,0.017,0.167,2.448)
to_plot_f$col <- c('lightblue','dodgerblue','lightsalmon','salmon')
rownames(to_plot_f) <- labs
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p1_f + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
library(cowplot)
to_plot$sem <- c(0.020,0.051,0.097,3.104)
View(to_plot)
# Plot female data
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p1_f + scale_y_break(c(4,20), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
View(to_plot_f)
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p1 + scale_y_break(c(4,14), ticklabels = c(0,2,4,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black')
p2 <- p1 + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2
p2_f
# Plot female data
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p2_f <- p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2_f
val_f <- c(1, 0.145, 1.363, 14.855, 20.349) # The last one is a dummy so that the scales are the same
to_plot_f <- data.frame(val_f)
to_plot_f$tissue <- labs
to_plot_f <- data.frame(val_f)
to_plot_f$tissue <- c(labs, "Dummy")
to_plot_f$ord <- c(1,2,3,4, 5)
to_plot_f$sem <- c(0.024,0.017,0.167,2.448, 3.104) # The last one is a dummy so that the scales are the same
to_plot_f$col <- c('lightblue','dodgerblue','lightsalmon','salmon', 'white')
rownames(to_plot_f) <- labs
rownames(to_plot_f) <- c(labs, "Dummy")
View(to_plot_f)
# Plot female data
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p2_f <- p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2_f
# Plot female data
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon', 'white')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p2_f <- p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('Day 9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2_f
to_plot_f <- data.frame(val_f)
to_plot_f$tissue <- c(labs, "Dummy")
to_plot_f$ord <- c(1,2,3,4, 5)
to_plot_f$sem <- c(0.024,0.017,0.167,2.448, NULL) # The last one is a dummy so that the scales are the same
to_plot_f <- data.frame(val_f)
to_plot_f$tissue <- c(labs, "Dummy")
to_plot_f$ord <- c(1,2,3,4, 5)
p1 <- ggplot(to_plot, aes(ord, val)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon')) +
geom_errorbar(aes(x = ord, ymin = val, ymax = val+sem), width = 0.5, color = 'black')
p2 <- p1 + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2
# Plot female data
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon', 'white')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p2_f <- p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2_f
plot_grid(p2, p2_f, nrow = 1)
ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon', 'white')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
to_plot_f <- data.frame(val_f)
to_plot_f$tissue <- c(labs, "Dummy")
to_plot_f$ord <- c(1,2,3,4, 5)
to_plot_f$sem <- c(0.024,0.017,0.167,2.448, 3.104) # The last one is a dummy so that the scales are the same
to_plot_f$col <- c('lightblue','dodgerblue','lightsalmon','salmon', 'white')
rownames(to_plot_f) <- c(labs, "Dummy")
gplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon', 'white')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon', 'white')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
# Plot female data
p1_f <- ggplot(to_plot_f, aes(ord, val_f)) + geom_bar(stat = 'identity', fill = c('dodgerblue','lightblue','#cc5500','salmon', 'white')) +
geom_errorbar(aes(x = ord, ymin = val_f, ymax = val_f+sem), width = 0.5, color = 'black')
p2_f <- p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank())
p2_f
plot_grid(p2, p2_f, nrow = 1)
p2
p2_f
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank(), axis.text = element_text(size = 2))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank(), axis.text = element_text(size = 18))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank(), axis.text = element_text(size = 14))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues', size = 14) +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank(), axis.text = element_text(size = 14))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression"), size = 14), x = NULL) + ggtitle('D9 Female Tissues', size = 14) +
theme_classic() + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_blank(), axis.text = element_text(size = 14))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues', size = 14) +
theme_classic() + theme(plot.title = element_text(hjust = 0.5, size = 14), axis.text.x = element_blank(), axis.text = element_text(size = 14))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5, size = 14), axis.text.x = element_blank(), axis.text = element_text(size = 14))
p1_f + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Female Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5, size = 14), axis.text.x = element_blank(),
axis.text = element_text(size = 14), axis.title.y = element_text(size = 14))
p1 + scale_y_break(c(4,14), ticklabels = c(0,2,4,14,16,18,20,22,24)) +
labs(y = expression(paste("Relative ", italic(fmr1), " Expression")), x = NULL) + ggtitle('D9 Male Tissues') +
theme_classic() + theme(plot.title = element_text(hjust = 0.5, size = 14), axis.text.x = element_blank(),
axis.text = element_text(size = 14), axis.title.y = element_text(size = 14))
load("C:/Users/Brokenman/Desktop/Graduate_School/Side_Projects/Anolis_RADs/HINDEX/Reference/MD/PostReview_genomiccline.RData")
library(gghybrid)
hindlabel_locus = esth(data.prep.object = prepdata$data.prep, read.data.precols = dat$precols,
include.Source = T, test.subject = 'locus',
nitt = 500, burnin = 200)
Hindex_loc <- hindlabel_locus$hi
View(Hindex_loc)
summary(Hindex_loc$h_posterior_mode)
View(Beta_mean)
Hindex <- hindlabel$hi
View(Hindex)
hindlabel_locus_nosource = esth(data.prep.object = prepdata$data.prep, read.data.precols = dat$precols,
include.Source = F, test.subject = 'locus',
nitt = 500, burnin = 200)
summary(Hindex_loc_nosource$h_posterior_mode)
summary(hindlabel_locus_nosource$hi$h_posterior_mode
)
save.image("C:/Users/Brokenman/Desktop/Graduate_School/Side_Projects/Anolis_RADs/HINDEX/Reference/MD/PostReview_genomiccline.RData")
setwd("C:/Users/Brokenman/Desktop/Github/SNP_analysis")
# Define species names
species_names <- c("wolf", "butterfly", "bluejay", "centro", "coffs", "DHLiz", "egk", "cherry", "jawfish", "kpeng")
# Create a list of genind objects for each species
genind_species_list <- list(wolf_dat, butterfly_dat, bluejay_dat, centro_dat, coffs_dat, DHLiz_data, egk_dat, cherry_dat,
jawfish_dat, kpeng_dat)
# Load required packages
library(adegenet)
library(knitr)
set.seed(123)
# Function to calculate genetic diversity and FIS
calculateGeneticDiversity <- function(pop) {
n_ind <- nInd(pop)  # Number of individuals
# Calculate observed heterozygosity (Ho)
Ho <- colSums(tab(pop) == 1) / n_ind
# Calculate allele frequencies (p and q)
p <- colSums(tab(pop) == 0) / (n_ind * 2)
q <- 1 - p
# Calculate expected heterozygosity (He)
He <- 1 - (p^2 + q^2)
# Calculate unbiased expected heterozygosity (uHe)
uHe <- He * (2 * n_ind / (2 * n_ind - 1))
# Calculate inbreeding coefficient (FIS)
FIS <- (mean(He) - mean(Ho)) / mean(He)
# Return the results
return(data.frame(Observed_Heterozygosity = Ho,
Expected_Heterozygosity = He,
Unbiased_Expected_Heterozygosity = uHe,
FIS = FIS))
}
# Define parameters
replicates <- c(100, 200, 400, 500, 750)  # Number of resampling replicates
sample_sizes <- c(2, 4, 6, 8, 10, 15, 20, 25, 30)  # Number of individuals per population
snp_counts <- c(50, 100, 200, 500, 1000, 1500, 2000)  # Number of SNPs
# Create a data frame to store the multiresults
multiresults <- data.frame(Species = character(),
Replicates = integer(),
Sample_Size = integer(),
SNP_Count = integer(),
Observed_Heterozygosity = numeric(),
Expected_Heterozygosity = numeric(),
Unbiased_Expected_Heterozygosity = numeric(),
FIS = numeric())
### Load in data
Dat <- readRDS("DHLiz_genlight.rds")
### Load you pacakges
library(tidyverse)
library(caret)
View(Dat)
# Isolate genetic data
Gen <- Dat$gen
View(Gen)
Ind <- Dat[sample(nInd(Dat), size = 30), ]
View(Ind)
# Isolate genetic data
Gen <- Dat[sample(nInd(Dat), size = 30), ]
remove(Ind)
# Replace NAs with 0
sampled_data@tab[is.na(sampled_data@tab)] <- 0
Gen@tab
View(Gen)
# Read in genind datasets for each species
file_names <- c('ArWolf_data.rds', 'bfly_data.rds', 'bluejay.rds', 'centro_data.rds','coffs_genind.rds','DH_Lizard_data.rds','egk_genind.rds',
'Cherry_data.rds', 'jawfish.rds', 'kpen_data.rds') # feel free to add more genind object s if you want
# Create an empty list to store the new datasets
new_datasets <- list()
# Loop through each file
for (i in 1:length(file_names)) {
# Read in the genind dataset from the RDS file
genind_data <- readRDS(file_names[i])
# Randomly sample 30 individuals
n_ind_subsample <- 30
sampled_data <- genind_data[sample(nInd(genind_data), size = n_ind_subsample), ]
# Replace NAs with 0
sampled_data@tab[is.na(sampled_data@tab)] <- 0
# Convert 'pop' to factor class with a new name (e.g., PopA, PopB, etc.)
new_pop_name <- paste0("Pop", letters[i])  # This will create PopA, PopB, PopC, ...
sampled_data$pop <- factor(rep(new_pop_name, nInd(sampled_data)))
# Store the sampled data with the new name in the list
new_datasets[[new_pop_name]] <- sampled_data
}
i = 1
# Read in the genind dataset from the RDS file
genind_data <- readRDS(file_names[i])
# Randomly sample 30 individuals
n_ind_subsample <- 30
sampled_data <- genind_data[sample(nInd(genind_data), size = n_ind_subsample), ]
# Replace NAs with 0
sampled_data@tab[is.na(sampled_data@tab)] <- 0
View(sampled_data)
View(Gen)
View(Dat)
View(sampled_data)
i = 6
# Read in the genind dataset from the RDS file
genind_data <- readRDS(file_names[i])
# Read in genind datasets for each species
file_names <- list.files(pattern = '*.rds')
i = 2
# Read in the genind dataset from the RDS file
genind_data <- readRDS(file_names[i])
file_names
### Load in data
Dat <- readRDS("bfly_data.rds")
View(Dat)
Test <- Dat$tab
View(Test)
View(Test)
